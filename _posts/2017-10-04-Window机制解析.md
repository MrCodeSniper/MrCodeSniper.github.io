---
layout:     post
title: Â  Â  Â Windowæœºåˆ¶è§£æ
subtitle: Â  ä»æºç å¼€å§‹
date:       2017-10-04
author: Â  Â  MrCodeSniper
header-img: img/home-bg-art.jpg
catalog: true
tags:
    - android
    - resource code
    - window
---


## Activityä¸‹çš„å¥¥ç§˜

é¦–å…ˆæˆ‘ä»¬å¾—è¿™çŸ¥é“ æ¯ä¸ªActivityä¸‹æŒæœ‰ç€å•ç‹¬çš„windowå¯¹è±¡ï¼Œæ˜¯ä»–åœ¨æ„ŸçŸ¥ç”¨æˆ·çš„è§¦æ‘¸äº‹ä»¶å¹¶åé¦ˆç»™activity

ä½†windowåªæ˜¯è§„å®šåŠŸèƒ½è§„èŒƒçš„æŠ½è±¡ç±» çœŸæ­£çš„å®ç°ç±»ä¸ºPhoneWindow ä»–å°†æ„ŸçŸ¥çš„äº‹ä»¶å‘é€ç»™Activityå¤„ç†

windowå› ä¸ºæ˜¯æ¯”è¾ƒæ ¸å¿ƒçš„ä»£ç æœ‰ç€éå¸¸é‡è¦çš„åŠŸèƒ½,androidä¸ºå…¶åˆ›å»ºäº†ä¸€ä¸ªç®¡ç†æ¥å£WindowManager,çœŸæ­£å®ç°ä¸ºWindowManagerImpl,å…¶ä»–ç±»é€šè¿‡WindowMangeræ¥é—´æ¥ä½¿ç”¨windowçš„åŠŸèƒ½

è™½ç„¶windowæ˜¯äººæœºäº¤äº’çš„æ ¸å¿ƒä½†æ˜¯çœŸæ­£æ˜¾ç¤ºè§†å›¾ç•Œé¢çš„æ˜¯View,ä¾é™„åœ¨Windowä¸Šçš„Viewæ ¹è§†å›¾ä¸ºdecorview,decorviewä¸‹æœ‰ç€ä¸€ä¸ªLinearLayoutå­è§†å›¾

ä»–åŒ…å«ç€titlebarå­è§†å›¾å’ŒcontentParentå­è§†å›¾ï¼Œtitlebarå°±æ˜¯æ ‡é¢˜æ è§†å›¾äº†,contentparentè§†å›¾å°±æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„setContentView(R.layout.activity_main)

çš„çˆ¶è§†å›¾äº†,æ­£æ˜¯è¿™æ ·åµŒå¥—çš„viewä¸windowä¸activityçš„å¸ƒå±€ï¼Œå½¢æˆäº†æˆ‘ä»¬androidäº¤äº’æ˜¾ç¤ºçš„åŸºç¡€,è€Œè¿™æ­£æ˜¯å‰äººç§¯ç´¯çš„å®è´µç»éªŒï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬é€ä¸ªåˆ†æ

## Activityä¸Window

Question1:Activityæ˜¯åœ¨ä»€ä¹ˆæ—¶æœºä¸Windowè”ç³»ä¸Šçš„å‘¢ï¼Ÿ

å…ˆçœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼š

```java
private WindowManager mWindowManager;
private Window mWindow;
final void attach(Context context, ActivityThread aThread,
            Instrumentation instr, IBinder token, int ident,
            Application application, Intent intent, ActivityInfo info,
            CharSequence title, Activity parent, String id,
            NonConfigurationInstances lastNonConfigurationInstances,
            Configuration config, String referrer, IVoiceInteractor voiceInteractor,
            Window window, ActivityConfigCallback activityConfigCallback) {
        attachBaseContext(context);

        mFragments.attachHost(null /*parent*/);

 Â  Â  Â  Â mWindow = new PhoneWindow(this, window, activityConfigCallback);//æ ¹æ®ä¼ è¿›æ¥çš„æŠ½è±¡ç±»åˆ›å»ºPhoneWindowå®ä¾‹
 Â  Â  Â  Â mWindow.setWindowControllerCallback(this);//è®¾ç½®å›è°ƒå’Œå…¶ä»–å‚æ•°ã€‚ã€‚ã€‚
 Â  Â  Â  Â mWindow.setCallback(this);
        mWindow.setOnWindowDismissedCallback(this);
        mWindow.getLayoutInflater().setPrivateFactory(this);
        if (info.softInputMode != WindowManager.LayoutParams.SOFT_INPUT_STATE_UNSPECIFIED) {
            mWindow.setSoftInputMode(info.softInputMode);
        }
        if (info.uiOptions != 0) {
            mWindow.setUiOptions(info.uiOptions);
        }
        mUiThread = Thread.currentThread();

        mMainThread = aThread;
        mInstrumentation = instr;
        mToken = token;
        mIdent = ident;
        mApplication = application;
        mIntent = intent;
        mReferrer = referrer;
        mComponent = intent.getComponent();
        mActivityInfo = info;
        mTitle = title;
        mParent = parent;
        mEmbeddedID = id;
        mLastNonConfigurationInstances = lastNonConfigurationInstances;
        if (voiceInteractor != null) {
            if (lastNonConfigurationInstances != null) {
                mVoiceInteractor = lastNonConfigurationInstances.voiceInteractor;
            } else {
                mVoiceInteractor = new VoiceInteractor(voiceInteractor, this, this,
                        Looper.myLooper());
            }
        }

 Â  Â  Â  Â mWindow.setWindowManager(//è·å–Windowç®¡ç†å™¨æ¥å£åˆ›å»ºWindowManagerImplå®ç°ç±»å¹¶ä¸windowå…³è”
 Â  Â  Â  Â  Â  Â  Â  Â (WindowManager)context.getSystemService(Context.WINDOW_SERVICE),
                mToken, mComponent.flattenToString(),
                (info.flags & ActivityInfo.FLAG_HARDWARE_ACCELERATED) != 0);
        if (mParent != null) {
            mWindow.setContainer(mParent.getWindow());
        }
        mWindowManager = mWindow.getWindowManager();
        mCurrentConfig = config;

        mWindow.setColorMode(info.colorMode);
    }
```

æŒæœ‰windowçš„å…¨å±€å¼•ç”¨,åœ¨attach()å‡½æ•°ä¸­ åˆ›å»ºäº†WindowManagerå¹¶åˆ›å»ºäº†PhoneWindowä¸ºwindowèµ‹å€¼,è°ƒç”¨mWindow.setWindowManagerä½¿å¾—windowå’Œç®¡ç†å™¨å…³è”


## Windowä¸DecorView

Question2:Windowæ˜¯åœ¨ä»€ä¹ˆæ—¶æœºä¸DecorViewè”ç³»ä¸Šçš„å‘¢ï¼Ÿ

### DecorViewçš„æ·±å…¥

Windowä½œä¸ºviewçš„ç®¡ç†ä¾é™„è€…,åœ¨Windowè¢«åˆ›å»ºæ—¶åº”è¯¥å°±æœ‰DecorViewå­˜åœ¨ é‚£åœ¨Windowè¢«åˆ›å»ºçš„è¿™æ®µæ—¶é—´é‡Œå‘ç”Ÿäº†ä»€ä¹ˆ?

```java
public void setContentView(@LayoutRes int layoutResID) {
        getWindow().setContentView(layoutResID);
        initWindowDecorActionBar();
    }
```
è¿™æ®µä»£ç æ˜¯ä¸æ˜¯å¾ˆç†Ÿ,è¿™æ˜¯æˆ‘ä»¬åœ¨oncreatç”Ÿå‘½å‘¨æœŸä¸­è®¾ç½®è‡ªèº«è§†å›¾å¸ƒå±€çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–ä¼šäº¤ç”±è‡ªèº«çš„windowè®¾ç½®xmlå¸ƒå±€,ç»§ç»­è·Ÿè¿›

```
@Override
  public void setContentView(int layoutResID) {
// mContentParent æ˜¯æ”¾ç½®çª—å£å†…å®¹çš„çˆ¶ viewgroup ï¼Œå¯èƒ½æ˜¯ decorView æœ¬èº«ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å®ƒçš„å­ viewgroup
// å¦‚æœ mContentParent æ˜¯ç©ºçš„ï¼Œé‚£ä¹ˆå°±è¯´æ˜ decorView æ˜¯ç©ºçš„
      if (mContentParent == null) {
 Â  Â  Â  Â  Â installDecor();//åˆ›å»ºdecorview
 Â  Â  Â } else if (!hasFeature(FEATURE_CONTENT_TRANSITIONS)) {
          mContentParent.removeAllViews();
      }

      if (hasFeature(FEATURE_CONTENT_TRANSITIONS)) {
          final Scene newScene = Scene.getSceneForLayout(mContentParent, layoutResID,
                  getContext());
          transitionTo(newScene);
      } else {
	// å°† layout å¸ƒå±€åŠ å…¥åˆ° mContentParent ä¸­å¹¶å»è§£æ layout xml æ–‡ä»¶
          mLayoutInflater.inflate(layoutResID, mContentParent);
      }
      mContentParent.requestApplyInsets();
// é€šçŸ¥ activity çª—å£å†…å®¹å·²ç»å‘ç”Ÿå˜åŒ–äº†
      final Callback cb = getCallback();
      if (cb != null && !isDestroyed()) {
          cb.onContentChanged();
      }
      mContentParentExplicitlySet = true;
  }
```
è¿™é‡Œå‡ºç°äº†ä¸¤ä¸ªåˆ†æ”¯ï¼š1.decorviewåˆ›å»ºåˆ†æ”¯ åˆ›å»ºå¥½ååˆ†æ”¯2.æŠŠæˆ‘ä»¬è®¾ç½®çš„å¸ƒå±€é€šè¿‡inflateè§£æå¹¶æ”¾å…¥mContentParentå†…å®¹æ ¹è§†å›¾

```
private void installDecor() {//åˆ›å»ºDecorView1
 Â  Â mForceDecorInstall = false;
    if (mDecor == null) {
        // å¦‚æœ decorview ä¸ºç©ºï¼Œè°ƒç”¨ generateDecor æ¥åˆ›å»º decorview
        mDecor = generateDecor(-1);
        mDecor.setDescendantFocusability(ViewGroup.FOCUS_AFTER_DESCENDANTS);
        mDecor.setIsRootNamespace(true);
        if (!mInvalidatePanelMenuPosted && mInvalidatePanelMenuFeatures != 0) {
            mDecor.postOnAnimation(mInvalidatePanelMenuRunnable);
        }
    } else {
 Â  Â  Â  Â mDecor.setWindow(this);//è¿™ä¸æ˜¯å…³è”ä»£ç  åªæ˜¯å°†æ¥å£ä½œä¸ºå…¨å±€å˜é‡ çœŸæ­£çš„å…³è”éœ€è¦èµ°windowManager
 Â  Â }
    if (mContentParent == null) {
      
 Â  Â  Â  Â mContentParent = generateLayout(mDecor);//ä¼ å…¥decorviewç”Ÿæˆlayout

        // Set up decor part of UI to ignore fitsSystemWindows if appropriate.
        mDecor.makeOptionalFitsSystemWindows();

        final DecorContentParent decorContentParent = (DecorContentParent) mDecor.findViewById(
                R.id.decor_content_parent);

        ...

        }
    }
}
```
åˆ†æ”¯1å‡ºç°äº†ä¸¤ä¸ªåˆ†æ”¯11ï¼šå¦‚æœä¸å­˜åœ¨ç¼“å­˜decorviewå°±æ‰§è¡Œç”Ÿæˆå‡½æ•°ï¼Œç»§ç»­èµ°è‹¥å­˜åœ¨ ä¾èµ–windowæ¥å£ åˆ†æ”¯12.è‹¥æ²¡æœ‰ç¼“å­˜å†…å®¹è§†å›¾éœ€è¦ç”Ÿæˆå†…å®¹è§†å›¾

```
protected DecorView generateDecor(int featureId) {//åˆ›å»ºDecorView2 åˆ†æ”¯11
 Â  Â // System process doesn't have application context and in that case we need to directly use
    // the context we have. Otherwise we want the application context, so we don't cling to the
    // activity.

    // å¾—åˆ° context ä¸Šä¸‹æ–‡
    Context context;
    if (mUseDecorContext) {
        Context applicationContext = getContext().getApplicationContext();
        if (applicationContext == null) {
            context = getContext();
        } else {
            context = new DecorContext(applicationContext, getContext().getResources());
            if (mTheme != -1) {
                context.setTheme(mTheme);
            }
        }
    } else {
        context = getContext();
    }
    // åˆ›å»º DecorView å¯¹è±¡
    return new DecorView(context, featureId, this, getAttributes());
}
```
åˆ†æ”¯11 åœ¨å¤„ç†å¥½contextç¯å¢ƒåæœ€ç»ˆé€šè¿‡new Decorviewç”ŸæˆDecorviewå¯¹è±¡
```
//åˆ†æ”¯12
protected ViewGroup generateLayout(DecorView decor) {//ç”Ÿæˆdecorviewçš„å¸ƒå±€ è¿”å›mContentParentå³æˆ‘ä»¬è®¾ç½®çš„å¸ƒå±€åŠ ä¸Šä¸€äº›ç³»ç»Ÿçš„ä¸»é¢˜ç­‰
 Â  // åº”ç”¨å½“å‰çš„ä¸»é¢˜ï¼Œæ¯”å¦‚è®¾ç½®ä¸€äº› window å±æ€§ç­‰
    ... 

    // æ ¹æ®ä¸»é¢˜è®¾ç½®å»é€‰æ‹© layoutResource
    // è¿™ä¸ª layoutResource ä¹Ÿå°±æ˜¯ DecorView çš„å­ View çš„å¸ƒå±€
    int layoutResource;
    int features = getLocalFeatures();

    ...

    else if ((features & (1 << FEATURE_NO_TITLE)) == 0) {
        // If no other features and not embedded, only need a title.
        // If the window is floating, we need a dialog layout
        if (mIsFloating) {
            TypedValue res = new TypedValue();
            getContext().getTheme().resolveAttribute(
                    R.attr.dialogTitleDecorLayout, res, true);
            layoutResource = res.resourceId;
        } else if ((features & (1 << FEATURE_ACTION_BAR)) != 0) {
            layoutResource = a.getResourceId(
                    R.styleable.Window_windowActionBarFullscreenDecorLayout,
                    R.layout.screen_action_bar);
        } else {
 Â  Â  Â  Â  Â  Â layoutResource = R.layout.screen_title; //mContentParentè§†å›¾ä¹Ÿå°±æ˜¯æˆ‘ä»¬è®¾ç½®contentviewçš„çˆ¶è§†å›¾ åˆ†æ”¯121
 Â  Â  Â  Â }
        // System.out.println("Title!");
    } else if ((features & (1 << FEATURE_ACTION_MODE_OVERLAY)) != 0) {
        layoutResource = R.layout.screen_simple_overlay_action_mode;
    } else {
        // Embedded, so no decoration is needed.
        layoutResource = R.layout.screen_simple;
        // System.out.println("Simple!");
    }

    mDecor.startChanging();
 Â  Â 
 Â  Â mDecor.onResourcesLoaded(mLayoutInflater, layoutResource);//å°†layoutResourceèµ„æºè½¬æ¢å¢åŠ åˆ°decorviewçš„å¸ƒå±€ä¸­ åˆ†æ”¯122
 Â  
 Â  Â ViewGroup contentParent = (ViewGroup)findViewById(ID_ANDROID_CONTENT);//setcontentviewçš„å†…å®¹å¸ƒå±€
 Â  Â if (contentParent == null) {
        throw new RuntimeException("Window couldn't find content container view");
    }

    if ((features & (1 << FEATURE_INDETERMINATE_PROGRESS)) != 0) {
        ProgressBar progress = getCircularProgressBar(false);
        if (progress != null) {
            progress.setIndeterminate(true);
        }
    }

    if ((features & (1 << FEATURE_SWIPE_TO_DISMISS)) != 0) {
        registerSwipeCallbacks();
    }

    // Remaining setup -- of background and title -- that only applies
    // to top-level windows.
    // èƒŒæ™¯è®¾ç½®å’Œæ ‡é¢˜è®¾ç½®
    if (getContainer() == null) {
        final Drawable background;
        if (mBackgroundResource != 0) {
            background = getContext().getDrawable(mBackgroundResource);
        } else {
            background = mBackgroundDrawable;
        }
        mDecor.setWindowBackground(background);

        final Drawable frame;
        if (mFrameResource != 0) {
            frame = getContext().getDrawable(mFrameResource);
        } else {
            frame = null;
        }
        mDecor.setWindowFrame(frame);

        mDecor.setElevation(mElevation);
        mDecor.setClipToOutline(mClipToOutline);

        if (mTitle != null) {
            setTitle(mTitle);
        }

        if (mTitleColor == 0) {
            mTitleColor = mTextColor;
        }
        setTitleColor(mTitleColor);
    }

 Â  Â mDecor.finishChanging();//å®Œæˆå›è°ƒ
 Â  Â 
    return contentParent;
}
```
åˆ†æ”¯12 åˆåˆ†å‡ºä¸¤ä¸ªåˆ†æ”¯ mContentParentçš„å¸ƒå±€layoutä¸ºåˆ†æ”¯121 æœ€æ ¸å¿ƒçš„æ˜¯ å°†æ‰€æœ‰layoutèµ„æºé€šè¿‡è§£æå™¨åŠ è½½ ä¸ºåˆ†æ”¯122

```xml
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:fitsSystemWindows="true">
	/* å¼¹å‡ºåŠ¨ä½œæ  */
    <ViewStub android:id="@+id/action_mode_bar_stub"
              android:inflatedId="@+id/action_mode_bar"
              android:layout="@layout/action_mode_bar"
              android:layout_width="match_parent"
              android:layout_height="wrap_content"
              android:theme="?attr/actionBarTheme" />
	/* æ ‡é¢˜æ  */
    <FrameLayout
        android:layout_width="match_parent" 
        android:layout_height="?android:attr/windowTitleSize"
        style="?android:attr/windowTitleBackgroundStyle">
        <TextView android:id="@android:id/title" 
            style="?android:attr/windowTitleStyle"
            android:background="@null"
            android:fadingEdge="horizontal"
            android:gravity="center_vertical"
            android:layout_width="match_parent"
            android:layout_height="match_parent" />
    </FrameLayout>
	/* æˆ‘ä»¬è‡ªè®¾ç½®çš„è§†å›¾ä¸ºå–ä»£è¿™ä¸ªFramelayout*/
    <FrameLayout android:id="@android:id/content"
        android:layout_width="match_parent" 
        android:layout_height="0dip"
        android:layout_weight="1"
        android:foregroundGravity="fill_horizontal|top"
        android:foreground="?android:attr/windowContentOverlay" />
</LinearLayout>
```
åˆ†æ”¯121 å°†mcontentParentå¸ƒå±€æ¸…æ™°æ˜“æ‡‚
```java
void onResourcesLoaded(LayoutInflater inflater, int layoutResource) {
    mStackId = getStackId();

    if (mBackdropFrameRenderer != null) {
        loadBackgroundDrawablesIfNeeded();
        mBackdropFrameRenderer.onResourcesLoaded(
                this, mResizingBackgroundDrawable, mCaptionBackgroundDrawable,
                mUserCaptionBackgroundDrawable, getCurrentColor(mStatusColorViewState),
                getCurrentColor(mNavigationColorViewState));
    }

 Â  Â mDecorCaptionView = createDecorCaptionView(inflater);
 Â  Â final View root = inflater.inflate(layoutResource, null);//å°†å¸ƒå±€èµ„æºè§£æä¸ºroot ä¹Ÿå°±æ˜¯decorviewä¸‹çš„mContentRoot
 Â  Â if (mDecorCaptionView != null) {
        if (mDecorCaptionView.getParent() == null) {
            addView(mDecorCaptionView,
                    new ViewGroup.LayoutParams(MATCH_PARENT, MATCH_PARENT));//ç»™decorviewåŠ ä¸ªæ ¹å¸ƒå±€
        }
        mDecorCaptionView.addView(root,
 Â  Â  Â  Â  Â  Â  Â  Â new ViewGroup.MarginLayoutParams(MATCH_PARENT, MATCH_PARENT));//ç»™ä¹‹å‰å¤„ç†è¿‡çš„viewåŠ ä¸ªæ ¹å¸ƒå±€è£¹ç€mContentRoot
 Â  Â } else {
        // Put it below the color views.
        // å°† root è§†å›¾æ·»åŠ åˆ° DecorView ä¸­
        addView(root, 0, new ViewGroup.LayoutParams(MATCH_PARENT, MATCH_PARENT));
    }
    // å¯ä»¥çœ‹å‡ºæˆå‘˜å˜é‡ mContentRoot å°±æ˜¯ DecorView çš„ç›´æ¥å­ View
    // ä¹Ÿå°±æ˜¯ mContentParent çš„çˆ¶è§†å›¾
    mContentRoot = (ViewGroup) root;
    initializeElevation();
}
```
åˆ†æ”¯122 ç»™decorviewä¸‹ contentParentä¸ŠåŠ äº†ä¸ªçˆ¶å¸ƒå±€ å¯èƒ½æ˜¯å› ä¸ºèµ„æºé…ç½®æˆ–è€…å¸ƒå±€éœ€è¦

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXè‡³æ­¤decorviewçš„æºç è§£æç»“æŸ


ä¹‹å‰è¯´è¿‡,DecorViewä¸‹æœ‰ç€titlebarå¸ƒå±€å’Œcontentå¸ƒå±€ åœ¨å¤§å¤šæ•°appæ²¡æœ‰titlebarçš„æƒ…å†µä¸‹ decorviewå¯èƒ½å°±æ˜¯contentæœ¬èº«æˆ–æ˜¯å…¶çˆ¶å¸ƒå±€
åœ¨setContentViewè¿™ä¸ªæ–¹æ³•ä¸‹ åšäº†ä»¥ä¸‹å·¥ä½œ
1.åˆ›å»ºDecorView å¹¶åœ¨installDecor()ä¸­mDecor.setWindow(this);å°†decorviewå’Œwindowè”ç³»èµ·æ¥ åˆ›å»ºäº†contentviewçš„çˆ¶è§†å›¾ä¸ºdecorviewå†…å®¹
æœ€ç»ˆç»è¿‡contextç¯å¢ƒé…ç½®ä¸‹new DecorViewåˆ›å»º
2.å°†è‡ªå®šä¹‰çš„è§†å›¾ layout_main.xml è¿›è¡Œè§£æå¹¶æ·»åŠ åˆ° mContentParent ä¸­ ä»£ç ï¼šmLayoutInflater.inflate(layoutResID, mContentParent);
3.é€šçŸ¥ activity çª—å£è§†å›¾å·²ç»æ”¹å˜äº†ï¼Œè¿›è¡Œç›¸å…³æ“ä½œ cb.onContentChanged();å›è°ƒé€šçŸ¥

ç›®å‰ä¸ºæ­¢çš„å†…å®¹æ˜¯decorviewå†…å®¹éƒ¨åˆ† ã€‚ã€‚ã€‚ã€‚ã€‚

###Windowä¸DecorViewè¿æ¥

æˆ‘ä»¬è¿˜ç¼ºä¸€ä¸ªå†…å®¹æ²¡è®² å³ decorviewä¸windowçš„è¿æ¥ æˆ‘ä»¬çŸ¥é“æ‰€æœ‰ä¸windowçš„æ“ä½œè¦é€šè¿‡WindowManager é‚£ä¹ˆå¦‚ä½•è®©decorviewä¸windowå…³è”å‘¢
è®©æˆ‘ä»¬çœ‹è¿™æ®µä»£ç 

```
void makeVisible() {
    if (!mWindowAdded) {
        // WindowManager æ˜¯ ViewManager çš„å®ç°ç±»
        ViewManager wm = getWindowManager();
        // å°† decorview æ·»åŠ åˆ° window ä¸­
 Â  Â  Â  Â wm.addView(mDecor, getWindow().getAttributes());//çœŸæ­£çš„å…³è”ä»£ç addview
 Â  Â  Â 	mWindowAdded = true;
    }
    // è®¾ç½® decorview å¯è§
    mDecor.setVisibility(View.VISIBLE);
}

```
è¿™æ®µä»£ç æ˜¯ActivityThread çš„ handleResumeActivity()ä¸­å›è°ƒäº†onResume()ä¹‹åæ‰§è¡Œäº†
ä¹Ÿå°±æ˜¯activityå¤„äºå‰å°æ—¶æ‰ä¸windowç»‘å®šå¯ä»¥äº¤äº’ï¼Œå°±ç»‘å®šwindow

ps:è¿™é‡Œæˆ‘ä»¬è¡¥å……è¯´æ˜ ActivityThread æ˜¯Android APPè¿›ç¨‹çš„åˆå§‹ç±» mainå‡½æ•°ä¸ºandroidappçš„ç¨‹åºå…¥å£ Â ä½†è¿™ä¸ªçº¿ç¨‹ä¸æ˜¯ä¸»çº¿ç¨‹ ä¸»çº¿ç¨‹æ˜¯åœ¨å…¶ä»–åœ°æ–¹åˆ›å»ºçš„ä¸“é—¨å¤„ç†ui è€Œmainå‡½æ•°è‚¯å®šæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„


è‡³æ­¤activity window decorviewä¸‰è€…ä¹‹é—´çš„è¿æ¥ æ„å»ºæˆæˆ‘ä»¬èƒ½äº¤äº’çš„åŠ¨æ€è§†å›¾





## æœ€åæ€»ç»“

æœ€ç»ˆçŒ®ä¸Šå­¦é•¿æ€»ç»“çš„ä¸€å¹…å›¾ æ„Ÿè°¢ğŸ™

[Windowæœºåˆ¶](http://ofyt9w4c2.bkt.clouddn.com/20170928/20170928102356.jpg)


- å‚è€ƒ [å­¦é•¿blog:Androidæºç è§£æ](http://yuqirong.me/2017/09/28/Window%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90(%E4%B8%80)%EF%BC%9A%E4%B8%8EDecorView%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/)
